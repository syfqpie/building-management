<div class="container-fluid">
    <div class="row g-3">
        <div class="col-12 text-end">
            <div class="dropdown">
                <button class="btn btn-outline-primary dropdown-toggle btn-sm"
                    type="button"
                    data-bs-toggle="dropdown"
                    aria-expanded="false">
                    <i class="fa-solid fa-gear"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-custom p-0">
                    <li *ngIf="currentUnit?.isActive">
                        <button class="dropdown-item"
                            [disabled]="isProcessing"
                            (click)="deactivate()">
                            <i class="fa-solid fa-lock"></i>
                            Deactivate
                        </button>
                    </li>
                    <li *ngIf="!currentUnit?.isActive">
                        <button class="dropdown-item"
                            [disabled]="isProcessing"
                            (click)="activate()">
                            <i class="fa-solid fa-lock-open"></i>
                            Activate
                        </button>
                    </li>
                    <li *ngIf="currentUnit?.isMaintenance">
                        <button class="dropdown-item"
                            [disabled]="isProcessing"
                            (click)="disableMaintenance()">
                            <i class="fa-solid fa-lock-open"></i>
                            Disable maintenance
                        </button>
                    </li>
                    <li *ngIf="!currentUnit?.isMaintenance">
                        <button class="dropdown-item"
                            [disabled]="isProcessing"
                            (click)="enableMaintenance()">
                            <i class="fa-solid fa-lock"></i>
                            Enable maintenance
                        </button>
                    </li>
                </ul>
            </div>
        </div>

        <div class="col-sm-12 col-md-3">
            <div class="card shadow border-0">
                <div class="card-body">
                    <h5 class="card-title">
                        Unit information
                    </h5>
                    <div class="mb-2">
                        <label class="fw-bold text-uppercase small">
                            Unit no.: 
                        </label>
                        <p class="text-muted small">
                            {{ currentUnit?.unitNo }}
                        </p>
                    </div>

                    <div class="mb-2">
                        <label class="fw-bold text-uppercase small">
                            Square feet:
                        </label>
                        <p class="text-muted small">
                            {{ currentUnit?.squareFeet }} sf
                        </p>
                    </div>

                    <div class="mb-2">
                        <label class="fw-bold text-uppercase small d-block">
                            Maintenance:
                        </label>
                        <p class="small d-inline-flex px-2 py-1 bg-opacity-10
                            border border-opacity-10 rounded-2 my-1"
                            [ngClass]="{
                                'bg-success text-success
                                    border-success': !currentUnit?.isMaintenance,
                                'bg-danger text-danger
                                    border-danger': currentUnit?.isMaintenance
                            }">
                            <span *ngIf="currentUnit?.isMaintenance; else isNotMaintenance">
                                <i class="fa-regular fa-circle-xmark my-auto"></i>
                                Maintenance
                            </span>
                            <ng-template #isNotMaintenance>
                                <span>
                                    <i class="fa-regular fa-circle-check my-auto"></i>
                                    Not maintenance
                                </span>
                            </ng-template>
                        </p>
                    </div>

                    <div class="mb-2">
                        <label class="fw-bold text-uppercase small d-block">
                            Active:
                        </label>
                        <p class="small d-inline-flex px-2 py-1 bg-opacity-10
                            border border-opacity-10 rounded-2 my-1"
                            [ngClass]="{
                                'bg-success text-success
                                    border-success': currentUnit?.isActive,
                                'bg-danger text-danger
                                    border-danger': !currentUnit?.isActive
                            }">
                            <span *ngIf="currentUnit?.isActive; else isNotActive">
                                <i class="fa-regular fa-circle-check my-auto"></i>
                                Active
                            </span>
                            <ng-template #isNotActive>
                                <span>
                                    <i class="fa-regular fa-circle-xmark my-auto"></i>
                                    Inactive
                                </span>
                            </ng-template>
                        </p>
                    </div>

                    <div class="mb-2">
                        <label class="fw-bold text-uppercase small">
                            Created at:
                        </label>
                        <p class="text-muted small">
                            {{ currentUnit?.createdAt | date : 'dd/MM/yyyy, h:mm a'}}
                        </p>
                    </div>

                    <div class="mb-2">
                        <label class="fw-bold text-uppercase small">
                            Last modified at:
                        </label>
                        <p class="text-muted small">
                            {{ currentUnit?.lastModifiedAt| date : 'dd/MM/yyyy, h:mm a' }}
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-12 col-md-8 d-flex">
            <div class="text-center m-auto"
                [ngClass]="{
                    'w-100': selectedRenter
                }">
                <!-- <input #renterSearchInput id="renterSearchInput" class="form-control" /> -->
                <div *ngIf="isAssignRenter; else isNotAssignRenter">
                    <div *ngIf="selectedRenter; else notSelected"
                        class="row">
                        <div class="col-sm-12 col-md-auto d-flex">
                            <div class="m-auto">
                                <img src="assets/images/illustrations/confirmation.png"
                                    style="width: 24rem" />
                                <p class="text-muted">Confirmation</p>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md text-start">
                            <div class="mb-2">
                                <label class="fw-bold text-uppercase small">
                                    Renter no.: 
                                </label>
                                <p class="text-muted small">
                                    {{ selectedRenter?.renterNo }}
                                </p>
                            </div>
        
                            <div class="mb-2">
                                <label class="fw-bold text-uppercase small">
                                    Name:
                                </label>
                                <p class="text-muted small">
                                    {{ selectedRenter?.name }}
                                </p>
                            </div>
    
                            <div class="mb-2">
                                <label class="fw-bold text-uppercase small">
                                    Email:
                                </label>
                                <p class="text-muted small">
                                    {{ selectedRenter?.email }}
                                </p>
                            </div>
    
                            <div class="mb-2">
                                <label class="fw-bold text-uppercase small">
                                    Phone number:
                                </label>
                                <p class="text-muted small">
                                    {{ selectedRenter?.phoneNumber }}
                                </p>
                            </div>
                            <button class="btn btn-primary me-2">
                                Confirm
                            </button>
                            <button class="btn btn-outline-primary"
                                (click)="cancelAssignRenter()">
                                Cancel
                            </button>
                        </div>
                    </div>
                    <ng-template #notSelected>
                        <form class="text-start">
                            <div>
                                <label class="form-label">
                                    Renter
                                </label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i *ngIf="isSearching; else isNotSearching"
                                            class="fa-solid fa-circle-notch fa-spin">
                                        </i>
                                        <ng-template #isNotSearching>
                                            <i class="fa-brands fa-searchengin"></i>
                                        </ng-template>
                                    </span>
                                    <input #renterSearchInput
                                        class="form-control"
                                        [disabled]="isSearching"
                                        placeholder="Search renter"
                                        list="encodings" />           
                                </div>
                            </div>
                        </form>
                        <div class="mt-3" *ngIf="searchedRenters.length > 0">
                            <div class="list-group list-group-flush shadow rounded">
                                <ng-template ngFor
                                    let-renter
                                    [ngForOf]="searchedRenters">
                                    <button class="list-group-item list-group-item-action"
                                        (click)="onSelectRenter(renter)">
                                        <p class="mb-0 small">
                                            <i class="fa-solid fa-building-user"></i>
                                            [{{ renter.renterNo }}] {{ renter.name }} - {{ renter.email }}
                                        </p>
                                    </button>                                
                                </ng-template>
                            </div>
                        </div>
                    </ng-template>
                </div>
                <ng-template #isNotAssignRenter>
                    <div>
                        <img src="assets/images/illustrations/no-information.png"
                            style="height: 14rem;">
                        <p class="text-muted">No information yet</p>
                        <button class="btn btn-primary"
                            (click)="toggleAssignRenter()">
                            Assign renter
                        </button>
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>